# 1.4 函数

函数是表示一系列语句的代码单元。

函数可以接受**参数**或值并**返回**单个值（或不返回）。要使用函数，对参数值使用函数调用，并将**函数调用**本身的使用替换为其返回值。

每个函数都有一个**类型签名** -- 参数的类型和返回类型。

函数受过程和数学函数概念的启发。

- 注意：C++函数本质上是过程，不遵循数学函数的确切定义或规则。

函数通常用于执行特定的任务。可以从程序的其他部分调用。在程序中调用函数之前，必须先声明和定义函数。
- 注意：常见的函数定义可能隐藏在其他包含的文件中（通常是为了方便和跨多个文件重用）。这是头文件的常见用法。

## 函数声明
**函数声明**是向编译器声明带有名称和类型签名的函数的存在。语法如下：
```cpp
int add2(int i); // 函数的类型为 (int) -> (int)
```
在上面的示例中，`int add2(int i)`函数向编译器声明了以下内容：
- 返回类型为`int`
- 函数名为`add2`
- 函数的参数个数为`1`
    - 第一个参数的类型为`int`
    - 第一个参数将在函数的内容中以名称`i`引用。

参数名是可选的；函数的声明也可以是以下内容:
```cpp
int add2(int); // 也允许省略函数参数名
```

根据`one-definition`规则，一个具有特定类型签名的函数只能在整个C++代码库中被声明或定义一次，这对于C++编译器是可见的。换句话说，不能重新定义具有特定类型签名的函数 -- 它们只能定义一次。因此，以下内容不是有效的C++代码：
```cpp
int add2(int i); // 编译器会注意到 add2 是一个函数 (int) -> int
int add2(int j); // 由于add2已经有了 (int) -> int 的定义，编译器会将其视为错误。
```

如果函数什么也不返回，它的返回类型将被写为void。如果不接受任何参数，则参数列表应为空。
```cpp
void do_something(); // 函数不接受任何参数，也不返回任何内容。
                     // 请注意，它仍然会影响它可以访问的变量。
```

## 函数调用
A function can be called after it has been declared. For example, the following program calls add2 with the value of 2 within the function of main:
```cpp
#include <iostream>
int add2(int i); // 声明函数 add2
                 // 注意: add2 仍然缺少定义.
                 // 即使它没有直接出现在代码中,add2 的 定义可以从另外一个对象文件链接进来。
int main()
{
    std::cout << add2(2) << "\n";  // add2(2)将在此时进行计算，并打印结果。
    return 0; 
}
```
这里，`add2(2)`是函数调用的语法。

## 函数定义
**函数定义**类似于声明，但它也包含在函数体中在调用函数时所执行的代码。

`add2`的函数定义示例可能是：
```cpp
int add2(int i)     // 传递到 int i 中的数据将在函数的花括号或“范围”中以名称`i`引用。
{
    int j = i + 2;  // 将变量j 定义为 i+2 的值。
    return j;       // 返回, 或者本质上替换对 add2 的函数调用。
}
```

## 函数重载
可以创建多个同名但参数不同的函数。
```cpp
int add2(int i) // 当用一个参数调用 add2() 时，将计算此定义中包含的代码。
{
    int j = i + 2;
    return j;
}
int add2(int i, int j) // 但是，当用两个参数调用add2()时，初始声明中的代码将被重载，而将计算此声明中的代码。
{
    int k = i + j + 2 ; 
    return k;
}
```

这两个函数都以相同的名称`add2`调用，但实际调用的函数直接决于调用中参数的数量和类型。在大多数情况下，C++编译器可以计算调用哪个函数。在某些情况下，必须显式地声明类型。

## 默认参数
函数参数的默认值只能在函数声明中指定。

```cpp
int multiply(int a, int b = 7); // b 的默认值为7
int multiply(int a, int b)
{
    return a * b; // 如果使用一个参数调用 multiply()，则该值将乘以默认值7。
} 
```

在本例中，可以使用一个或两个参数调用`multiply()`。如果只给出一个参数，则b的默认值为7。默认参数必须放在函数的后一个参数中。例如：

```cpp
int multiply(int a = 10, int b = 20); // 这是合法的
int multiply(int a = 10, int b);      // 这是非法的，因为 int a 在前面
```

## 特殊函数调用 - 运算符
C++中存在与 `name_of_function(value1，value2，value3)` 语法不同的特殊函数调用。最常见的例子是运算符。

某些特殊字符序列将被编译器简化为函数调用，例如`!`, `+`, `-`, `*`, `%`, 和 `<<`等。这些特殊字符通常与非编程使用相关联，或者用美化(例如，`+`字符通常在C++编程中以及在初等数学中都被认为是加法符号)。

C++用一种特殊的语法处理这些字符序列；但是，本质上，每个操作符的出现都被简化为一个函数调用。例如下面的C++表达式：
```cpp
3+3
```

相当于以下函数调用：

```cpp
operator+(3, 3)
```

所有运算符函数名都以运算符开头。

在C++的直接前身C中，不能通过提供具有不同类型签名的附加定义来赋予运算符函数名称不同的含义，而在C++中，这是有效的。在C++中，在一个唯一的函数名下“隐藏”额外的函数定义在C++中称为**运算符重载**，在C++中这是一种相对常见但并不通用的约定。